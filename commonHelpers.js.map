{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst loader = document.querySelector('.loader');\nconst loader2 = document.querySelector('.loader2');\n\nexport function hideLoader() {\n  loader.classList.add('visually-hidden');\n  loader2.classList.add('visually-hidden');\n}\n\nexport async function searchImages(searchInput, page) {\n  const API_KEY = '43234755-a337228de2a5121df872aa78d';\n  if (page.currentPage === 1) {\n    loader.classList.remove('visually-hidden');\n  } else {\n    loader2.classList.remove('visually-hidden');\n  }\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: API_KEY,\n        q: searchInput,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 100,\n        page: page.currentPage,\n      },\n    });\n\n    page.currentPage += 1;\n    return response;\n  } catch (error) {\n    throw new Error(error.message);\n  }\n}\n","export function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        tags,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class='card'><a class=\"gallery-link\" href=\"${largeImageURL}\"><img class='image' src='${webformatURL}' alt='${tags}'></a>\n        <div class='description'>\n        <div class='title-text'><h4 class='title'>Likes</h4><p class='text'>${likes}</p></div>\n        <div class='title-text'><h4 class='title'>Views</h4><p class='text'>${views}</p></div>\n        <div class='title-text'><h4 class='title'>Comments</h4><p class='text'>${comments}</p>\n        </div><div class='title-text'><h4 class='title'>Downloads</h4><p class='text'>${downloads}</p></div>\n        </div></li>`\n    )\n    .join('');\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { searchImages } from './js/pixabay-api.js';\nimport { hideLoader } from './js/pixabay-api.js';\nimport { createMarkup } from './js/render-functions.js';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.searchInput');\nconst list = document.querySelector('.list');\nconst submitBtn = document.querySelector('.submitBtn');\nconst loadMore = document.querySelector('.loadMore');\nconst page = { currentPage: 1 };\n\nsubmitBtn.disabled = true;\n\nfunction saveToLocalStorage(key, value) {\n  localStorage.setItem(key, value);\n}\n\nfunction getFromLocalStorage(key) {\n  const data = localStorage.getItem(key);\n  return data ? data : null;\n}\ninput.addEventListener('input', () => {\n  if (input.value.trim() !== '') {\n    submitBtn.disabled = false;\n  } else {\n    submitBtn.disabled = true;\n  }\n});\n\nform.addEventListener('submit', handleClick);\nloadMore.addEventListener('click', loadClick);\n\nasync function handleClick(event) {\n  event.preventDefault();\n  const searchInputValue = input.value.trim();\n  page.currentPage = 1;\n  if (searchInputValue !== '') {\n    list.innerHTML = '';\n    loadMore.classList.add('visually-hidden');\n    saveToLocalStorage('searchInputValue', searchInputValue);\n    try {\n      const response = await searchImages(searchInputValue, page);\n      if (response.data.hits.length === 0) {\n        hideLoader();\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n          backgroundColor: '#EF4040',\n          messageColor: '#fff',\n          timeout: 3000,\n        });\n      } else {\n        hideLoader();\n        list.insertAdjacentHTML('beforeend', createMarkup(response.data.hits));\n        lightbox.refresh();\n        const checkImagesInterval = setInterval(() => {\n          const images = list.querySelectorAll('img');\n          const allImagesLoaded = [...images].every(img => img.complete);\n          if (allImagesLoaded) {\n            clearInterval(checkImagesInterval);\n            const totalPages = Math.ceil(\n              response.data.totalHits / response.config.params.per_page\n            );\n            if (response.config.params.page >= totalPages) {\n              return iziToast.warning({\n                position: 'topRight',\n                backgroundColor: '#00A36C',\n                message:\n                  \"We're sorry, but you've reached the end of search results.\",\n              });\n            } else {\n              loadMore.classList.remove('visually-hidden');\n            }\n          }\n        }, 50);\n      }\n      form.reset();\n      submitBtn.disabled = true;\n    } catch (error) {\n      hideLoader();\n      iziToast.error({\n        message: `${error}`,\n        position: 'topRight',\n        backgroundColor: '#EF4040',\n        messageColor: '#fff',\n        timeout: 3000,\n      });\n    }\n  }\n}\n\nasync function loadClick() {\n  loadMore.classList.add('visually-hidden');\n  const searchInputValue = getFromLocalStorage('searchInputValue');\n  try {\n    const response = await searchImages(searchInputValue, page);\n    console.log(response);\n    const totalPages = Math.ceil(\n      response.data.totalHits / response.config.params.per_page\n    );\n    hideLoader();\n    list.insertAdjacentHTML('beforeend', createMarkup(response.data.hits));\n    lightbox.refresh();\n    scroll();\n    const checkImagesInterval = setInterval(() => {\n      const images = list.querySelectorAll('img');\n      const allImagesLoaded = [...images].every(img => img.complete);\n      if (allImagesLoaded) {\n        clearInterval(checkImagesInterval);\n        if (response.config.params.page >= totalPages) {\n          loadMore.classList.add('visually-hidden');\n          return iziToast.warning({\n            position: 'topRight',\n            backgroundColor: '#00A36C',\n            message:\n              \"We're sorry, but you've reached the end of search results.\",\n          });\n        }\n      } else {\n        loadMore.classList.remove('visually-hidden');\n      }\n    }, 50);\n  } catch (error) {\n    console.log(error);\n    hideLoader();\n    iziToast.error({\n      message: `${error}`,\n      position: 'topRight',\n      backgroundColor: '#EF4040',\n      messageColor: '#fff',\n      timeout: 3000,\n    });\n  }\n}\nfunction scroll() {\n  const card = list.firstElementChild;\n  const height = card.getBoundingClientRect().height;\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n\nconst lightbox = new SimpleLightbox('.list a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n"],"names":["loader","loader2","hideLoader","searchImages","searchInput","page","API_KEY","response","axios","error","createMarkup","arr","webformatURL","tags","largeImageURL","likes","views","comments","downloads","form","input","list","submitBtn","loadMore","saveToLocalStorage","key","value","getFromLocalStorage","data","handleClick","loadClick","event","searchInputValue","iziToast","lightbox","checkImagesInterval","img","totalPages","scroll","height","SimpleLightbox"],"mappings":"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"}